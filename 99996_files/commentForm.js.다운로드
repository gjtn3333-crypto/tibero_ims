function popupManagerListForMail(mailType, formId) {
    var width = 800;
	var height = 565;
	var top = getY(height);
	var left = getX(width);
	var property = "top=" + top
         + ",left=" + left
         + ",width=" + width
         + ",height=" + height
         + ",scrollbars=1,resize=1";
	var groupCode = 'qa';
	var url = context + "/ims/comment/popupUserListForMail.do?mailType=" + mailType;

	if(formId != null && formId != "") url = url + "&formId=" + formId;
	// + "&groupCode=" + groupCode;
	var ow = window.open(url , "popUserWindow", property);
}

/*
function popupManagerListForMail(mailType) {
    var width = 668;
	var height = 480;
	var top = getY(height);
	var left = getX(width);
	var property = "top=" + top
         + ",left=" + left
         + ",width=" + width
         + ",height=" + height
         + ",scrollbars=1,resize=1";
	var groupCode = 'qa';
	var url = context + "/ims/comment/popupUserListForMail.do?mailType=" + mailType;
	// + "&groupCode=" + groupCode;
	var ow = window.open(url , "popUserWindow", property);
}
*/

function deleteManagerEmail(dest) {
	for (var i=(dest.length-1); i>=0; i--) {
    	if (dest.options[i].selected) {
      		dest.options[i] = null;
		}
	}
}

function addCommentAttachFile() {
    var tableObj = document.getElementById("attachCommentTable");
    var tRows = tableObj.rows;
    var tLength = tRows.length;
    if (tLength >= 10) {
        alert("Sorry! Cannot attach more than 10 files.");
        return;
    }
    var newRow = tableObj.insertRow(tLength);
    var newCell = newRow.insertCell(0);
    newCell.className = "data borderHidden";
    newCell.innerHTML = getCommentFileHTML(tLength);
}

function getCommentFileHTML(index) {
	s = "<input type=\"file\" name=\"uploadFiles[" + index + "]\" class=\"input uploadFilesClass\" style=\"width:40%; height: 25px;\" value=\"\">";
	return s;
}

/*
function deleteComment(issueId, commId)
{
	if (confirm("Are you sure you want to delete this action?"))
	{
		location.href = context + "/ims/comment/removeComment.do?issueId=" + issueId + "&commentId=" + commId;
	}
}
*/

function deleteComment(issueId, commId)
{
	if (confirm("Are you sure you want to delete this action?"))
	{
		// ���� �׼ǿ��� üũ(�����׼Ǹ� ��������)
		CommentDwr.chkDeleteComment(issueId, commId,
			{callback:function(data){
					if(data == 1) location.href = context + "/ims/comment/removeComment.do?issueId=" + issueId + "&commentId=" + commId;
					else alert("You can delete the latest action only.");
			 }}
		);
	}
}

// addEmail
function addEmail(mailType, name, email, formId) {
	var dest = null;
	if (mailType == "T") {
		if(formId != null && formId == "processForm")	dest = document.processForm.mailToIH;
    else	dest = document.commentForm.mailTo;
	} else {
		if(formId != null && formId == "processForm")	dest = document.processForm.mailCcIH;
		else dest = document.commentForm.mailCc;
	}
	if (!isDuplicateEmail(email, dest)) {
    	var destSize = dest.length;
    	var opt = null;
    	dest.options[destSize++] = new Option(name + "(" + email + ")", email, false, false);
	}
}
/*
function addEmail(mailType, name, email) {
	var dest = null;
	if (mailType == "T") {
    	dest = document.commentForm.mailTo;
	} else {
		dest = document.commentForm.mailCc;
	}
	if (!isDuplicateEmail(email, dest)) {
    	var destSize = dest.length;
    	var opt = null;
    	dest.options[destSize++] = new Option(name + "(" + email + ")", email, false, false);
	}
}
*/